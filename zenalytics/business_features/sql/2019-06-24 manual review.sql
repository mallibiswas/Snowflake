-- 2019-06-24

-- FIX FOURSQUARE
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Golf Course", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5cf17eb6727f63000160f2e4';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Office", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5cdc370a6b225f0001232c28';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Golf Course", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '59d6928da6335e0008581983';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Coffee Shop", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5d04161e9af4020001984eb8';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Night Club", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5cfebdd37a5d69000100613d';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Irish Pub", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5935a5b64a4f9f00100963d6';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Irish Pub", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '57d7c304f4c47f000a94034d';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Irish Pub", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '57d7c30cf4c47f000ec95af4';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "New American Restaurant", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '550360021081cd1c20b1a606';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "New American Restaurant", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '55035fe11081cd1c0c01ec24';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "New American Restaurant", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '55035ff11081cd1c178832ea';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Night Club", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5cfebdd37a5d69000100613d';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Golf Course", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5cf17eb6727f63000160f2e4';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Office", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5cdc370a6b225f0001232c28';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Golf Course", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '59d6928da6335e0008581983';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Coffee Shop", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5d04161e9af4020001984eb8';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Irish Pub", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '5935a5b64a4f9f00100963d6';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Irish Pub", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '57d7c304f4c47f000a94034d';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "Irish Pub", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '57d7c30cf4c47f000ec95af4';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "New American Restaurant", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '550360021081cd1c20b1a606';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "New American Restaurant", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '55035fe11081cd1c0c01ec24';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET foursquare = parse_json( '{ "hours": {}, "name": "None", "primary_category": "New American Restaurant", "venue_id": NULL}' ), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID = '55035ff11081cd1c178832ea';

-- GOOGLE PLACE_ID CORRECTIONS
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJQ__gWwmbbIcR8dMcDisL79o" }' ) WHERE BUSINESS_ID = '5cf17ea78e5a5a0001114507';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJl8Hd6WEs5IgRGq8voFrYL9I" }' ) WHERE BUSINESS_ID = '5a0f03147c3313000d464a1c';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJ7RBoyXx-gogRq8Z5hHU0A18" }' ) WHERE BUSINESS_ID = '5d09138d7a5d69000100e4c4';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJlx79QR0AzoURKhJz0L2r8qw" }' ) WHERE BUSINESS_ID = '5d0abe25c7c3b50001ac2e23';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJ02-UVl4--4kRdffZHW5-nTM" }' ) WHERE BUSINESS_ID = '5d0a886fcd1ec700010316f4';
-- new peet's location in a mall. This place_id is to pull the mall location data. Later will manually fix the details.
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJzd0QJFHQmoARl3hsmQZsqfI" }' ) WHERE BUSINESS_ID = '5d0ba07caa4379000110db41';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJ63n3UetL9IgR0BR9OaGrq9Y" }' ) WHERE BUSINESS_ID = '5d0ab7dfaa4379000110d495';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJs4cZb9TpIogR8QAYIovs5m8" }' ) WHERE BUSINESS_ID = '5d0c0bc0cd1ec70001032ed8';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJaaxRB8ctO4gRKOqb87d6CA4" }' ) WHERE BUSINESS_ID = '5d0c0bc0a47fd40001973f94';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJFaJSLC8tO4gRW42BbvAiRqE" }' ) WHERE BUSINESS_ID = '5d0c0bc0c7c3b50001ac407c';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJLxmZ5bYczoURuJWu4r3_IQM" }' ) WHERE BUSINESS_ID = '5d0ac141c7c3b50001ac2e6b';
-- restaurant location in a hotel. This place_id is to pull the mall location data. Later will manually fix the details.
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJ__-_hyN0RogRSqOaVjCQ9ks" }' ) WHERE BUSINESS_ID = '5cf80e082cd3240001657827';
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED=FALSE, MANUAL_REVIEW=FALSE, google = parse_json( '{ "place_id": "ChIJa6-DGnQe2YgRUuUXZe6OlzU" }' ) WHERE BUSINESS_ID = '59ce5d699a5666000ca3274f';

-- MANUAL CORRECTIONS
-- Location doesn't appear to be open yet, job postings for a new coffee bar but doesn't appear on their location page. Curious to see how long it takes for google to map it.
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=TRUE, valid_rec = TRUE WHERE BUSINESS_ID IN ('5cf6b690a2036b000157e8a7');

UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'place_id', NULL, TRUE), foursquare = OBJECT_INSERT(foursquare, 'venue_id', NULL, TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0aabe48fc233000190e447'); 
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'formatted_address', '9009 Talking Stick Way, Scottsdale, AZ 85258, United States', TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0aabe48fc233000190e447'); 
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'name', 'Kids That Rip - Scottsdale, AZ', TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0aabe48fc233000190e447');

UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'place_id', NULL, TRUE), foursquare = OBJECT_INSERT(foursquare, 'venue_id', NULL, TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0b832f8fc233000190ec79'); 
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'formatted_address', '486 Poinsettia Ave., Clearwater, FL, 33767, United States', TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0b832f8fc233000190ec79'); 
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'name', 'Irish 31 Pub House & Eatery', TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0b832f8fc233000190ec79'); 
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'geometry', NULL, TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0b832f8fc233000190ec79');

UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'place_id', NULL, TRUE), foursquare = OBJECT_INSERT(foursquare, 'venue_id', NULL, TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0ba4a3cd1ec700010322ce'); 
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'formatted_address', '2408 Preston Road, Plano, TX 75093, United States', TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0ba4a3cd1ec700010322ce'); 
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'name', 'bellagreen', TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0ba4a3cd1ec700010322ce'); 
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET processed=TRUE, manual_review=FALSE, google = OBJECT_INSERT(google, 'geometry', NULL, TRUE), updated = CURRENT_TIMESTAMP()::timestamp_ntz WHERE BUSINESS_ID IN ('5d0ba4a3cd1ec700010322ce');

-- MARK GOOD
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET MANUAL_REVIEW = FALSE WHERE BUSINESS_ID IN ('5cf845206f9c22000177bc79','5cfa984c727f630001618d1e','5cfa984c6f9c22000177d809','5d016cb2a4b1870001f6b355','5cfebdd39af4020001980a4b','5d0400afe630d40001ca3550','5d0400af9af4020001984d07','5cfe8fcd727f63000161c65e','5cfebd977c3fa00001a954e2','5d0163b47c3fa00001a976f0','5d0400af7a5d69000100a21d','5d0414537a5d69000100a3be','5cfebd97e630d40001c9f1fb','5d0400af5f74540001f2bc65','5d0ac41dde122700018c2217','5cf17eb6727f63000160f2e4','5d04161e9af4020001984eb8','5cfebdd37a5d69000100613d');

-- Foursquare 404's. Google place-id's look great. Re-run.
UPDATE ZENALYTICS.BUSINESS_FEATURES.BUSINESS_FEATURES_RAW SET PROCESSED = FALSE, MANUAL_REVIEW=FALSE 
WHERE BUSINESS_ID IN ('5cf817872cd324000165790b', '5cf8305b2cd3240001657a81', '5cf8306c727f630001616da8', '5cf8307c2cd3240001657a82', '5cf8308a8e5a5a000111cba3', '5cf8309a2cd3240001657a83', '5cf830ab8e5a5a000111cba6', '5cf830bafc625300011e1a35', '5cf830c96f9c22000177bae6', '5cf861618e5a5a000111cf5a', '5cf937a68e5a5a000111d3fd', '5cf95ae66f9c22000177c71c', '5cf95af58e5a5a000111d829', '5cf976912cd3240001658802', '5cf98f148e5a5a000111dc1b', '5cfaa58a2cd32400016599e7', '5cfadf6c6f9c22000177df3a');
