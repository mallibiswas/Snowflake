version: 2

sources:
  - name: PRIVACY
    description: This is a copy of data loaded through bash scripts for privacy
    freshness:
      error_after:
        count: 36
        period: hour
    loaded_at_field: CREATED
    tables:
      - name: PRIVACY_REQUEST
        description: data on blacklisted contact record(s) that will be deleted from ads targeting
        columns:
          - name: REQUEST_ID
            type: VARCHAR(16777216)
            description: Indentifier for request
            tests:
              - not_null:
                  severity: warn
              - unique:
                  severity: warn
          - name: ROOT_BUSINESS_ID
            type: VARCHAR(16777216)
          - name: CONTACT_INFO
            type: VARCHAR(16777216)
            description: anonoymized contact information
          - name: CONTACT_METHOD
            type: VARCHAR(16777216)
          - name: PORTAL_ID
            type: VARCHAR(16777216)
            description: Unique indentifier for poratl
          - name: REQUEST_TYPE
            type: VARCHAR(16777216)
            description: request type access,erasure,rectification
          - name: SOURCE
            type: VARCHAR(16777216)
            description: source request generated by 
          - name: CREATED
            type: TIMESTAMP
          - name: COMPLETED
            type: TIMESTAMP
            description: completion timestamp
          - name: EXPECTED_RESPONSE_SOURCE
            type: ARRAY
            description: sources effected by request
          - name: ASOF_DATE
            type: DATE
            description: date ingested
      - name: PRIVACY_RESPONSE
        description: Response to privacy requesst
        columns:
          - name: RESPONSE_ID
            type: VARCHAR(16777216)
            tests:
              - not_null:
                  severity: warn
              - unique:
                  severity: warn
          - name: REQUEST_ID
            type: VARCHAR(16777216)
            tests:
              - relationships:
                  to: source('PRIVACY', 'PRIVACY_REQUEST')
                  field: REQUEST_ID
                  severity: warn
          - name: PAYLOAD
            type: ARRAY
          - name: SOURCE
            type: VARCHAR(16777216)
          - name: SOURCE
            type: VARCHAR(16777216)
            description: source request generated by 
          - name: CREATED
            type: TIMESTAMP
          - name: ASOF_DATE
            type: DATE
